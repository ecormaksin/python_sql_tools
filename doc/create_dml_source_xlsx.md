# 接続先のデータベースからDMLの作成元となるxlsxファイルを作成する処理（`create_dml_source_xlsx` モジュール）

## 実行手順

### 1. 各種ファイルの準備

- 設定ファイル（「[設定ファイルの準備](../README.md#12-設定ファイルの準備)」参照）

### 2. コマンドの実行

`python -m create_dml_source_xlsx --help` で実行時のパラメーターを確認できます。

以下は日本語で表にまとめたものです。

| ショート | ロング           | 必須 | 説明                                                                                                                                        |
|------|---------------|:--:|-------------------------------------------------------------------------------------------------------------------------------------------|
| -c   | --app-config  | －  | 当スクリプト制御用設定ファイル（.json）のパスを指定します。<br/>未指定の場合、プロジェクト ルートの 'app_config.json' を検索します。                                                         |
| -C   | --db-config   | －  | データベース接続用の設定ファイル（.json）のパスを指定します。<br/>未指定の場合、プロジェクト ルートの 'db_config.json' を検索します。                                                         |
| -T   | --tables      | －  | xlsx作成対象のテーブル名をカンマ区切りで指定します。<br/>未指定の場合は接続先データベースのすべてのテーブルを対象にします。                                                                        |
| -d   | --destination | －  | xlsxファイルの出力先フォルダーのパスを指定します。<br/>未指定の場合は一時フォルダ（`tempfile.gettempdir()`）の`python_sql_tools/dml_source_xlsx/<実行日時(%Y%m%d-%H%M%S-%f)>`に出力します。 |
| -n   | --file-name   | －  | xlsxのファイル名を指定します。<br/>未指定の場合は `dml_source.xlsx` で出力します。                                                                                   |
